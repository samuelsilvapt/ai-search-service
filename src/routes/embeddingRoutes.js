// see canvas for full code